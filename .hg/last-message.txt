Resolving multi-threading issues. Am almost ready to upload to github pending one more read through

